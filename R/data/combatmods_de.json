/* - Top level node: Topic 
*    -- Array with
*       --- 1-n combinations of conditions
*       --- The criterion that allows to select the correct set of modifiers
*       --- A list with 2-n sets of modifiers
*/
{
/* MIXED CLOSE & RANGED COMBAT */
"TargetSize": [{
    "Conditions": {"Hero.Weapon.WeaponType": ["Melee", "Unarmed"]},
    "Criterion": "Opponent.TargetSize",
    "Modifiers": {
        "Tiny":   {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Ratte, Kröte, Spatz"},
        "Small":  {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Rehkitz, Schaf, Ziege"},
        "Medium": {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Mensch, Zwerg, Esel"},
        "Large":  {"at": {"op": "+", "arg":  0}, "pa": {"op": "*", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Oger, Troll, Rind"},
        "Huge":   {"at": {"op": "+", "arg":  0}, "pa": {"op": "*", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Drache, Riese, Elefant"}
    }
},
{
    "Conditions": {"Hero.Weapon.WeaponType": "Shield"},
    "Criterion": "Opponent.TargetSize",
    "Modifiers": {
        "Tiny":   {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Ratte, Kröte, Spatz"},
        "Small":  {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Rehkitz, Schaf, Ziege"},
        "Medium": {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Mensch, Zwerg, Esel"},
        "Large":  {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Oger, Troll, Rind"},
        "Huge":   {"at": {"op": "+", "arg":  0}, "pa": {"op": "*", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Drache, Riese, Elefant"}
    }
},
{
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged"},
    "Criterion": "Opponent.TargetSize",
    "Modifiers": {
        "Tiny":   {"at": {"op": "+", "arg":  -8}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Ratte, Kröte, Spatz"},
        "Small":  {"at": {"op": "+", "arg":  -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Rehkitz, Schaf, Ziege"},
        "Medium": {"at": {"op": "+", "arg":   0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Mensch, Zwerg, Esel"},
        "Large":  {"at": {"op": "+", "arg":   4}, "pa": {"op": "*", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Oger, Troll, Rind"},
        "Huge":   {"at": {"op": "+", "arg":   8}, "pa": {"op": "*", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Drache, Riese, Elefant"}
    }
}],

"UnderWater": [{
    "Conditions": {"Hero.Weapon.WeaponType": ["Melee", "Unarmed", "Shield"]},
    "Criterion": "Environment.UnderWater",
    "Modifiers": { /* These levels are not explicitly part of the rules */
        "Dry":       {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg":  0}, "do": {"op": "+", "arg":  0}, "label": "", "example": ""},
        "KneeDeep":  {"at": {"op": "+", "arg": -1}, "pa": {"op": "+", "arg": -1}, "do": {"op": "+", "arg": -1}, "label": "", "example": ""},
        "WaistDeep": {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": -2}, "do": {"op": "+", "arg": -2}, "label": "", "example": ""},
        "ChestDeep": {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": -4}, "do": {"op": "+", "arg": -4}, "label": "", "example": ""},
        "NeckDeep":  {"at": {"op": "+", "arg": -5}, "pa": {"op": "+", "arg": -5}, "do": {"op": "+", "arg": -5}, "label": "", "example": ""},
        "Submerged": {"at": {"op": "+", "arg": -6}, "pa": {"op": "+", "arg": -6}, "do": {"op": "+", "arg": -6}, "label": "", "example": ""}
    }
},
{   /* TODO: CHECK */
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged"},
    "Criterion": "Environment.UnderWater",
    "Modifiers": { /* These levels are not explicitly part of the rules */
        "Dry":       {"at": {"op": "+", "arg": 0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg":  0}, "label": "", "example": ""},
        "KneeDeep":  {"at": {"op": "*", "arg": 0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -1}, "label": "", "example": ""},
        "WaistDeep": {"at": {"op": "*", "arg": 0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -2}, "label": "", "example": ""},
        "ChestDeep": {"at": {"op": "*", "arg": 0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -4}, "label": "", "example": ""},
        "NeckDeep":  {"at": {"op": "*", "arg": 0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -4}, "label": "", "example": ""},
        "Submerged": {"at": {"op": "*", "arg": 0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -6}, "label": "", "example": ""}
    }
}],

/* CLOSE COMBAT ONLY */
"CloseCombatRange": [/*{ # no effects if opponent has a short weapon
    "Conditions": {"Opponent.CloseCombatRange": "Short"},
    "Criterion": "Hero.Weapon.CloseCombatRange",
    "Modifiers": {
        "Short":  {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Medium": {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Long":   {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}}
    }
},*/
{
    "Conditions": {"Hero.Weapon.WeaponType": ["Melee", "Unarmed"], "Opponent.CloseCombatRange": "Medium"},
    "Criterion": "Hero.Weapon.CloseCombatRange",
    "Modifiers": {
        "Short":  {"at": {"op": "+", "arg":  -2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Medium": {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Long":   {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}}
    }
},
{
    "Conditions": {"Hero.Weapon.WeaponType": ["Melee", "Unarmed"], "Opponent.CloseCombatRange": "Long"},
    "Criterion": "Hero.Weapon.CloseCombatRange",
    "Modifiers": {
        "Short":  {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Medium": {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Long":   {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}}
    }
},
{
    "Conditions": {"Hero.Weapon.WeaponType": ["Shield"]},
    "Criterion": "Opponent.CloseCombatRange",
    "Modifiers": {
        "Short":  {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Medium": {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Long":   {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}}
    }
}],

"CrampedSpace": [{ /* Unarmed is not in the conditions because Unarmed implies a short reach */
    "Conditions": {"Environment.CrampedSpace": "Cramped", "Hero.Weapon.WeaponType": "Melee"},
    "Criterion": "Hero.Weapon.CloseCombatRange",
    "Modifiers": {
        "Short":  {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0},  "do": {"op": "+", "arg": 0}},
        "Medium": {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": -4}, "do": {"op": "+", "arg": 0}},
        "Long":   {"at": {"op": "+", "arg": -8}, "pa": {"op": "+", "arg": -8}, "do": {"op": "+", "arg": 0}}
    }
},
{
    "Conditions": {"Environment.CrampedSpace": "Cramped", "Hero.Weapon.WeaponType": "Shield"}, 
    "Criterion": "Hero.Weapon.CloseCombatRange",
    "Modifiers": {
        "Short":  {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": -2}, "do": {"op": "+", "arg": 0}},
        "Medium": {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": -3}, "do": {"op": "+", "arg": 0}},
        "Long":   {"at": {"op": "+", "arg": -6}, "pa": {"op": "+", "arg": -4}, "do": {"op": "+", "arg": 0}}
    }
}],


/* RANGED COMBAT ONLY */
"RangedCombatRange": [{
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged"},
    "Criterion": "Hero.Weapon.RangedCombatRange",
    "Modifiers": {
        "Short":  {"at": {"op": "+", "arg":  2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Medium": {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}},
        "Far":    {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}}
    }
}],

"Movement": [{
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged", "Hero.MeansOfMovement": "OnFoot"},
    "Criterion": "Hero.Movement",
    "Modifiers": {
        "Stationary": {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Slow":       {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Fast":       {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""}
    }
},
{
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged", "Hero.MeansOfMovement": "Mounted"},
    "Criterion": "Hero.MountedMovement",
    "Modifiers": {
        "Standing": {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Walk":     {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Trot":     {"at": {"op": "^", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Gallop":   {"at": {"op": "+", "arg": -8}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""}
    }
},
{
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged"},
    "Criterion": "Opponent.Movement",
    "Modifiers": {
        "Stationary": {"at": {"op": "+", "arg":  2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Slow":       {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Fast":       {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""}
    }
},
{   /* Using EvasiveMovement also as criterion merely to increase performance */
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged", "Opponent.EvasiveMovement": "Zigzagging"},
    "Criterion": "Opponent.EvasiveMovement",
    "Modifiers": {
        "None":       {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": ""},
        "Zigzagging": {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": 0}, "example": "Ziel schlägt Haken"}
    }
}],

/* ISSUES THAT NEED TO COME LAST BECAUSE OF THE '^' OPERATOR */
"Visibility": [{
    "Conditions": {"Hero.Weapon.WeaponType": ["Melee", "Unarmed", "Shield"]},
    "Criterion": "Environment.Visibility",
    "Modifiers": {
        "Clearly":    {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg":  0}, "do": {"op": "+", "arg":  0}, "label": "Klare Sicht", "example": ""},
        "Impaired":   {"at": {"op": "+", "arg": -1}, "pa": {"op": "+", "arg": -1}, "do": {"op": "+", "arg": -1}, "label": "Leichte Störung der Sicht", "example": "Leichtes Blattwerk, Morgendunst"},
        "ShapesOnly": {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": -2}, "do": {"op": "+", "arg": -2}, "label": "Ziel als Silhouette erkennbar", "example": "Nebel, Mondlicht"},
        "Barely":     {"at": {"op": "+", "arg": -3}, "pa": {"op": "+", "arg": -3}, "do": {"op": "+", "arg": -3}, "label": "Ziel schemenhaft erkennbar", "example": "Starker Nebel, Sternenlicht"},
        "NoVision":   {"at": {"op": "%./%", "arg":  2}, "pa": {"op": "^", "arg":  0}, "do": {"op": "^", "arg":  0}, "label": "Ziel unsichtbar", "example": "Dichter Rauch, völlige Dunkelheit"}
    }
},
{
    "Conditions": {"Hero.Weapon.WeaponType": "Ranged"},
    "Criterion": "Environment.Visibility",
    "Modifiers": { /* Dodge modifiers are taken from close combat */
        "Clearly":    {"at": {"op": "+", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg":  0}, "label": "Klare Sicht", "example": ""},
        "Impaired":   {"at": {"op": "+", "arg": -2}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -1}, "label": "Leichte Störung der Sicht", "example": "Leichtes Blattwerk, Morgendunst"},
        "ShapesOnly": {"at": {"op": "+", "arg": -4}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -2}, "label": "Ziel als Silhouette erkennbar", "example": "Nebel, Mondlicht"},
        "Barely":     {"at": {"op": "+", "arg": -6}, "pa": {"op": "+", "arg": 0}, "do": {"op": "+", "arg": -3}, "label": "Ziel schemenhaft erkennbar", "example": "Starker Nebel, Sternenlicht"},
        "NoVision":   {"at": {"op": "^", "arg":  0}, "pa": {"op": "+", "arg": 0}, "do": {"op": "^", "arg":  0}, "label": "Ziel unsichtbar", "example": "Dichter Rauch, völlige Dunkelheit"}
    }
}]
}